---

# Image Classification - ITMO University Lab

Этот репозиторий содержит лабораторную работу по курсу машинного обучения в университете ИТМО, посвященную обработке и классификации изображений различных видов транспорта.

---

## Описание

В данной лабораторной работе проводится анализ и классификация изображений транспортных средств (автомобили, велосипеды, лодки, поезда, самолеты). Основной акцент сделан на построении сверточной нейронной сети (CNN), применении методов Transfer Learning и визуализации эмбеддингов для анализа качества модели.

## Содержимое репозитория

- **`notebooks/`**: Директория с Jupyter ноутбуками
  - **`result.ipynb`**: Основной ноутбук с реализацией и анализом
- **`src/`**: Директория с исходным кодом и данными
  - **`dataset/`**: Директория с собранными данными
  - **`apis.txt`**: Файл с API-ключами для сбора данных
- **`results/`**: Директория с результатами
  - **`models/`**: Сохраненные модели
  - **`embeddings/`**: Сохраненные эмбеддинги и их визуализации
- **`logs/`**: Директория с логами обучения
  - **`tensorboard/`**: Логи для TensorBoard
  - **`train_cnn_model_logs/`**: Текстовые логи обучения
- **`data/`**: Собранные данные
  - **`animals/`**: Спаршенные данные для классификации животных
  - **`kaggle_animals/`**: Данные животных с kaggle
  - **`kaggle_full/`**: Изображения архитектуры с kaggle
  - **`regular/`**: Спаршенные изображения архитектуры
  - **`test/`**: Тестовые изображения для проверки модели
  - **`test_animals/`**: Тестовые изображения для проверки модели
  - **`test_bad_cars/`**: Тестовые изображения для проверки модели
  - **`test_cars/`**: Тестовые изображения для проверки модели
  - **`unsplash-cars/`**: Спаршенные изображения автомобилей
- **`README.md`**: Описание проекта (вы читаете этот файл)

---

## Реализованные методы

1. **Сбор данных**:
   - Автоматический сбор изображений с Unsplash API
   - Многопоточная загрузка для ускорения процесса
   - Автоматическое переключение между API-ключами при исчерпании лимитов

2. **Обработка изображений**:
   - Изменение размера (resize) и нормализация
   - Аугментация данных: случайное горизонтальное отражение, вращение
   - Разделение данных на тренировочную, валидационную и тестовую выборки

3. **Разработка собственной CNN модели**:
   - Многослойная сверточная архитектура
   - Batch Normalization для стабилизации обучения
   - Dropout для предотвращения переобучения
   - AdaptiveAvgPool для работы с изображениями разного размера

4. **Transfer Learning**:
   - Использование предобученной ResNet18
   - Fine-tuning последних слоев модели
   - Сравнение производительности с собственной CNN

5. **Визуализация эмбеддингов**:
   - PCA (метод главных компонент)
   - t-SNE (t-distributed Stochastic Neighbor Embedding)
   - UMAP (Uniform Manifold Approximation and Projection)
   - Анализ качества кластеризации классов

## Установка и запуск

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/your-username/image-GameTrue.git
   cd image-GameTrue
   ```

2. Установите необходимые зависимости:
   ```bash
   pip install -r requirements
   ```

3. Запустите Jupyter Notebook:
   ```bash
   jupyter notebook notebooks/result.ipynb
   ```

## Основные результаты

В ходе работы было выявлено, что:
- Собственная CNN модель достигает точности 78% на валидационной и тестовой выборках
- Transfer Learning с ResNet18 показал меньшую эффективность на данном наборе данных
- Визуализация эмбеддингов демонстрирует четкое разделение между классами, с некоторыми пересечениями из-за шумных данных
- Наблюдается корреляция между качеством собранных данных и точностью классификации
- Модель успешно определяет транспортные средства на изображениях из внешних источников

---

## Технологии и библиотеки

- Python 3.8+
- PyTorch и TorchVision для построения и обучения нейронных сетей
- TensorBoard для мониторинга процесса обучения
- Matplotlib для визуализации результатов
- Scikit-learn для PCA и t-SNE
- UMAP для продвинутой визуализации эмбеддингов
- Requests для сбора данных через API
- PIL (Pillow) для работы с изображениями
- NumPy для численных вычислений

---

## Проблемы и решения

В процессе работы были выявлены следующие проблемы:
- Шум в собранных данных (нерелевантные изображения в некоторых классах)
- Ограниченное количество качественных изображений для некоторых классов

Решения:
- Ограничение количества изображений на класс для минимизации шума
- Тщательный выбор классов с достаточным количеством качественных данных
- Применение техник регуляризации (Dropout, Weight Decay) для борьбы с шумом в данных

---

## Контакты

Если у вас есть вопросы или предложения, вы можете связаться со мной через GitHub: [GameTrue](https://github.com/GameTrue).

---